kind: pipeline
name: default

steps:
- name: kaniko
  image: banzaicloud/drone-kaniko
  settings:
    username: 
      from_secret: docker-hub-username
    password: 
      from_secret: docker-hub-password
    repo: registry.kramergroup.science/workflows/matsci-base
    build_args: 
    - S3_ACCESS_KEY_ID=${aws-access-key-id}
    - S3_SECRET_ACCESS_KEY=${aws-secret-access-key}
    - S3_HOST=${S3_HOST}
    secrets: [aws-access-key-id,aws-secret-access-key,S3_HOST]
  environment:
    S3_ACCESS_KEY_ID:
      from_secret: aws-access-key-id
    S3_SECRET_ACCESS_KEY:
      from_secret: aws-secret-access-key
    S3_HOST:
      from_secret: s3-host